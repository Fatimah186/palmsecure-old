<!DOCTYPE html>
<html>
<head>
  <title>Student Details</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <link rel="stylesheet" type="text/css" href="student.css">
</head>

<body>
  <div class="navbar">
    <div class="logo-container">
        <img src="PALMSECURE LOGO2.png" alt="Logo" class="logo" id="logo">
    
    </div>
    <div class="welcome-message" id="welcomeMessage"><Welcome>Welcome admin!<span id="welcomeName"></span></div>
    <div class="welcome-container">
        <div class="dropdown-arrow" id="dropdownArrow"></div>
        <div class="dropdown-content" id="dropdown">
            <a href="home.html">Home</a>
            <a href="#">Logout</a>
        </div>
        
    </div>
</div>
  <!-- <h1>Student Details</h1> -->
  
  <div id="search-container">
    <div class="search-input-container">
      <input type="text" id="search-input" placeholder="Enter Register Number">
    </div>
    <button id="search-button" class="">Search</button>
  </div>
  
  <table id="students-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Year</th>
        <th>Department</th>
        <th>Register Number</th>
        <th>Phone Number</th>
        <th>Email</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
  <style>
    
body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f2f2f2;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow-y: auto;
      margin-top: 50px;
    }

    
    h1 {
      margin: 20px 0;
      font-size: 32px;
    }

    /* ... Rest of your styles ... */

    #search-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 20px;
    }
    .menu {
    position: absolute;
    top: 10px;
    /* right: 3px; */
    margin-left: 970px;
    list-style: none;
    display: flex;
    gap: 50px;
}

.menu li a {
    text-decoration: none;
    color: #333;
}
.menu li a:hover{
    color: rgb(95, 133, 146);
  }
  /* studentprofile.css */
/* ... (your existing styles) */

.navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    position: absolute;
    top: 10px;
    left: 20px;
    height: 40px;
}

.logo-container {
    display: flex;
    align-items: center;
    cursor: pointer;
}

.logo {
    width: 40px;
    height: 40px;
    margin-right: 10px;
}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    z-index: 1;
}

.dropdown-content a {
    color: black;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
}

.dropdown-content a:hover {
    background-color: #f1f1f1;
}

.welcome-container {
    display: flex;
    align-items: center;
    position: relative;
}

.dropdown-arrow {
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-top: 6px solid black;
    margin-left: 5px;
    cursor: pointer;
}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #f9f9f9;
    min-width: 160px;
    box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
    z-index: 1;
    transform-origin: top;
    transform: scaleY(0);
    transition: transform 0.3s ease-in-out;
}

.welcome-container:hover .dropdown-content {
    transform: scaleY(1);
}
    .search-input-container {
      flex-grow: 1;
      margin-right: 10px;
      position: relative;
    }
    .search-input-container {
  display: flex;
  align-items: center;
  border: 2px solid #ccc;
  border-radius: 30px;
  padding: 5px 15px;
  background-color: white;
  box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
}

#search-input {
  border: none;
  flex-grow: 1;
  margin-left: 10px;
  padding: 8px;
  font-size: 16px;
  outline: none;
}


    .search-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      background-color: transparent;
      cursor: pointer;
      transition: transform 0.3s, background-color 0.3s;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      margin-left: 10px;
    }

    .search-btn:hover {
      background-color: rgba(83, 105, 118, 0.5);
      transform: scale(1.1);
    }

    .search-icon {
      color: white;
      font-size: 20px;
    }

    #students-table {
      width: 98%;
      max-width: auto;
      margin-top: 20px;
      background-color: white;
      box-shadow: 0px 5px 10px rgba(0, 0, 0, 0.1);
      border-radius: 100px;
      
    }

    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid black;
    }

    th {
      background-color: #f2f2f2;
    }

  
   
h1 {
  text-align: center;
}

table {
  border-collapse: collapse;
  width: 100%;
}

 

  #search-container {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    margin-bottom: 10px;
    
  }

  .search-input-container {
    flex-grow: 1;
    margin-right: 10px;
    
  }

  .search-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      background-color: transparent;
      cursor: pointer;
      transition: transform 0.3s, background-color 0.3s;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      margin-left: 10px;
    }

    .search-btn:hover {
      background-color: rgba(83, 105, 118, 0.5);
      transform: scale(1.1);
    }

    .search-icon {
      color: white;
      font-size: 20px;
    }


button {
  padding: 4px 8px;
}
.verified-row {
      background-color: rgb(187, 210, 197); /* Green color */
    }
    .not-verified-row {
      background-color:rgb(129, 153, 166);  /* Red color */
    }
    
  </style>

  <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-database.js"></script>
  <script>
    // Firebase configuration
const firebaseConfig = {
    apiKey: "AIzaSyAk0foljioWF7Yde0GihotbmzW_bUxLPlw",
  authDomain: "registrationform-e4460.firebaseapp.com",
  databaseURL: "https://registrationform-e4460-default-rtdb.firebaseio.com",
  projectId: "registrationform-e4460",
  storageBucket: "registrationform-e4460.appspot.com",
  messagingSenderId: "899025377950",
  appId: "1:899025377950:web:d9d3fb4b97edb022aab98f",
  measurementId: "G-HJPSD2JERL"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);

// Get a reference to the database
const database = firebase.database();

// Get the table body
const tableBody = document.querySelector('tbody');
const searchInput = document.getElementById('search-input');
const searchButton = document.getElementById('search-button');
searchButton.addEventListener('click', searchStudentByRegisterNumber);
// Load and display student details from Firebase
database.ref('students').on('value', (snapshot) => {
  tableBody.innerHTML = '';

  snapshot.forEach((childSnapshot) => {
    const student = childSnapshot.val();
    const row = document.createElement('tr');
    const nameCell = document.createElement('td');
    const yearCell = document.createElement('td');
    const departmentCell = document.createElement('td');
    const regNumberCell = document.createElement('td');
    const phoneCell = document.createElement('td');
    const emailCell = document.createElement('td');
    const statusCell = document.createElement('td');
    const actionCell = document.createElement('td');
    const verifyButton = document.createElement('button');
    const cancelVerifyButton = document.createElement('button');
    const deleteButton = document.createElement('button');
    

    nameCell.textContent = student.name;
    yearCell.textContent = student.year;
    departmentCell.textContent = student.department;
    regNumberCell.textContent = student.regNumber;
    phoneCell.textContent = student.phone;
    emailCell.textContent= student.email;
    statusCell.textContent = student.status;
    verifyButton.textContent = 'Verify';
    verifyButton.dataset.studentId = childSnapshot.key;
    verifyButton.addEventListener('click', verifyStudent);


    cancelVerifyButton.textContent = 'Cancel Verification';
    cancelVerifyButton.dataset.studentId = childSnapshot.key;
    cancelVerifyButton.addEventListener('click', cancelVerifyStudent);


    deleteButton.innerHTML = '<i class="fas fa-trash"></i>'; 
    deleteButton.dataset.studentId = childSnapshot.key;
    deleteButton.addEventListener('click', deleteStudent);
    if (student.status === 'verified') {
          row.classList.add('verified-row');
        }
        else {
          row.classList.add('not-verified-row');
        }
    row.appendChild(nameCell);
    row.appendChild(yearCell);
    row.appendChild(departmentCell);
    row.appendChild(regNumberCell);
    row.appendChild(phoneCell);
    row.appendChild(emailCell);
    row.appendChild(statusCell);
    row.dataset.registerNumber = student.regNumber;
    actionCell.appendChild(verifyButton);
    actionCell.appendChild(cancelVerifyButton);
    actionCell.appendChild(deleteButton);

    row.appendChild(actionCell);

    tableBody.appendChild(row);
  });
});

// Verify student
function verifyStudent(event) {
  const studentId = event.target.dataset.studentId;
  const studentRef = database.ref('students').child(studentId);
  studentRef.update({ status: 'verified' })
    .then(() => {
      alert('Student verified successfully!');
    })
    .catch((error) => {
      console.error(error);
    });
}
// ... Your existing code ...

function deleteStudent(event) {
  const studentId = event.target.dataset.studentId;
  const studentRef = database.ref('students').child(studentId);
  studentRef.remove()
    .then(() => {
      alert('Student deleted successfully!');
    })
    .catch((error) => {
      console.error(error);
    });
}
// ... Your existing code ...

function cancelVerifyStudent(event) {
  const studentId = event.target.dataset.studentId;
  const studentRef = database.ref('students').child(studentId);
  studentRef.update({ status: 'pending' }) // Change status to "pending"
    .then(() => {
      alert('Verification cancelled successfully!');
    })
    .catch((error) => {
      console.error(error);
    });
}
function searchStudentByRegisterNumber() {
      // Reset the display for new searches
      tableBody.querySelectorAll('tr').forEach((row) => {
        row.style.display = '';
      });

      const registerNumber = searchInput.value.trim();

      if (registerNumber !== '') {
        let found = false;

        tableBody.querySelectorAll('tr').forEach((row) => {
          if (row.dataset.registerNumber === registerNumber) {
            row.style.display = ''; // Show the row
            row.scrollIntoView({ behavior: 'smooth' }); // Scroll to the found student
            found = true;
          } else {
            row.style.display = 'none'; // Hide other rows
          }
        });

        if (!found) {
          alert('Student with the provided register number not found.');
        }
      }
    }

const dropdownArrow = document.getElementById("dropdownArrow");
const dropdownContent = document.getElementById("dropdown");

// Handle arrow click
dropdownArrow.addEventListener("click", (event) => {
    event.stopPropagation(); // Prevent the body click event
    dropdownContent.style.display = "block";
});

// Handle body click to close the dropdown
document.body.addEventListener("click", () => {
    dropdownContent.style.display = "none";
});

// Prevent body click event propagation when clicking inside the dropdown
dropdownContent.addEventListener("click", (event) => {
    event.stopPropagation();
});
const logoutOption = document.querySelector("#dropdown a[href='#']");
logoutOption.addEventListener("click", (event) => {
    event.preventDefault(); // Prevent default link behavior
    alert("User logged out successfully");
    window.location.href = "student.html"; // Redirect to student.html
});

// ... Your existing code ...

// ... Your existing code ...

  </script>
</body>
</html>
